<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Naver Apt Briefing</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@400;500;700&family=Space+Grotesk:wght@500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <style>
      :root {
        --bg: #f4f6f8;
        --surface: #ffffff;
        --surface-soft: #e8edf2;
        --text: #0f1720;
        --muted: #5f6873;
        --accent: #0369a1;
        --accent-soft: #0ea5e9;
        --warn: #b45309;
        --border: #d5dbe3;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "IBM Plex Sans KR", sans-serif;
        color: var(--text);
        background:
          radial-gradient(circle at 10% -10%, #bae6fd 0%, rgba(186, 230, 253, 0) 30%),
          radial-gradient(circle at 95% 0%, #fed7aa 0%, rgba(254, 215, 170, 0) 35%),
          var(--bg);
      }

      .container {
        width: min(1200px, 94vw);
        margin: 24px auto 56px;
      }

      .headline {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        gap: 16px;
        margin-bottom: 22px;
      }

      .headline h1 {
        margin: 0;
        font-family: "Space Grotesk", sans-serif;
        font-size: clamp(1.4rem, 2.5vw, 2rem);
        letter-spacing: -0.02em;
      }

      .headline p {
        margin: 6px 0 0;
        color: var(--muted);
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 12px;
      }

      .panel {
        grid-column: span 12;
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 14px;
        box-shadow: 0 10px 20px rgba(15, 23, 32, 0.04);
      }

      .panel h2 {
        margin: 0 0 10px;
        font-size: 1rem;
        font-family: "Space Grotesk", sans-serif;
      }

      .panel.two {
        grid-column: span 6;
      }

      .panel.four {
        grid-column: span 4;
      }

      .row {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }

      input,
      button,
      textarea {
        font: inherit;
      }

      input,
      textarea {
        width: 100%;
        padding: 10px 11px;
        border: 1px solid var(--border);
        border-radius: 10px;
        background: #fff;
      }

      button {
        padding: 10px 14px;
        border: 0;
        border-radius: 10px;
        background: var(--accent);
        color: #fff;
        cursor: pointer;
        font-weight: 600;
      }

      button.alt {
        background: #0b2535;
      }

      button.warn {
        background: var(--warn);
      }

      .split {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
      }

      .muted {
        color: var(--muted);
        font-size: 0.92rem;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border: 1px solid var(--border);
        border-radius: 999px;
        padding: 4px 10px;
        background: var(--surface-soft);
        margin-right: 6px;
        margin-bottom: 6px;
        font-size: 0.88rem;
      }

      .list {
        max-height: 180px;
        overflow: auto;
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 8px;
      }

      .status {
        margin-top: 8px;
        color: var(--muted);
        font-size: 0.9rem;
        min-height: 20px;
      }

      .table {
        width: 100%;
        border-collapse: collapse;
      }

      .table th,
      .table td {
        text-align: left;
        padding: 8px 6px;
        border-bottom: 1px solid var(--border);
        font-size: 0.9rem;
      }

      @media (max-width: 960px) {
        .panel.two,
        .panel.four {
          grid-column: span 12;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="headline">
        <div>
          <h1>Naver Apt Briefing Dashboard</h1>
          <p>관심 단지 수집, 추세/비교 차트, 급매 후보를 한 화면에서 확인합니다.</p>
        </div>
        <div id="userBadge" class="pill">로그인 필요</div>
      </div>

      <div class="grid">
        <section class="panel four">
          <h2>1) 계정</h2>
          <div class="split">
            <input id="email" type="email" placeholder="email@example.com" />
            <input id="password" type="password" placeholder="비밀번호 (8자 이상)" />
          </div>
          <div class="row" style="margin-top: 8px">
            <button id="registerBtn">회원가입</button>
            <button id="loginBtn" class="alt">로그인</button>
            <button id="meBtn" class="warn">내 정보</button>
            <button id="logoutBtn" class="warn">로그아웃</button>
          </div>
          <div class="status" id="authStatus"></div>
        </section>

        <section class="panel four">
          <h2>2) 관심 단지 등록</h2>
          <div class="row" style="margin-top: 8px">
            <input id="watchComplexKeyword" type="text" placeholder="단지명 검색 (2자 이상)" />
            <button id="searchComplexBtn" class="alt">단지명 검색</button>
          </div>
          <div class="list" id="watchComplexSearchList" style="margin-top: 8px"></div>
          <div class="row" style="margin-top: 8px">
            <input id="watchComplexUrl" type="text" placeholder="네이버 단지 URL 또는 complexNo" />
            <button id="parseComplexUrlBtn" class="alt">URL에서 번호 추출</button>
          </div>
          <div class="split">
            <input id="watchComplexNo" type="number" placeholder="complex_no" />
            <input id="watchComplexName" type="text" placeholder="단지명 (선택)" />
          </div>
          <div class="row" style="margin-top: 8px">
            <button id="addWatchBtn">등록</button>
            <button id="loadWatchBtn" class="alt">목록 조회</button>
          </div>
          <div class="row" style="margin-top: 8px">
            <input id="liveWatchPage" type="number" value="1" min="1" placeholder="page" />
            <input id="liveWatchMax" type="number" value="10" min="1" max="30" placeholder="단지당 최대 매물 수" />
            <button id="loadLiveWatchBtn" class="warn">실시간 매물 조회</button>
          </div>
          <div class="list" id="watchList" style="margin-top: 8px"></div>
          <div class="list" id="liveWatchList" style="margin-top: 8px"></div>
        </section>

        <section class="panel four">
          <h2>3) 수동 수집</h2>
          <div class="split">
            <input id="ingestComplexNo" type="number" placeholder="complex_no" />
            <input id="ingestPage" type="number" value="1" min="1" />
          </div>
          <div class="row" style="margin-top: 8px">
            <button id="ingestBtn">지금 수집</button>
            <button id="metaBtn" class="alt">메타 확인</button>
          </div>
          <div class="status" id="ingestStatus"></div>
        </section>

        <section class="panel four">
          <h2>4) 요금제 / 더미 결제</h2>
          <div class="row">
            <div id="billingPlanBadge" class="pill">플랜: 확인 필요</div>
          </div>
          <div class="row" style="margin-top: 8px">
            <button id="billingMeBtn">내 플랜 조회</button>
            <button id="billingCheckoutBtn" class="alt">PRO 결제 시작(더미)</button>
          </div>
          <div class="row" style="margin-top: 8px">
            <input id="billingCheckoutToken" type="text" placeholder="checkout_token (자동 입력)" />
            <button id="billingCompleteBtn" class="warn">결제 완료 처리</button>
          </div>
          <div class="status" id="billingStatus"></div>
        </section>

        <section class="panel">
          <h2>5) 알림 채널 설정 (이메일/텔레그램)</h2>
          <div class="split">
            <input id="notifyEmailAddress" type="email" placeholder="알림 이메일 주소" />
            <input id="notifyTelegramChatId" type="text" placeholder="텔레그램 chat_id" />
          </div>
          <div class="row" style="margin-top: 8px">
            <label class="pill"><input id="notifyEmailEnabled" type="checkbox" /> 이메일 사용</label>
            <label class="pill"><input id="notifyTelegramEnabled" type="checkbox" /> 텔레그램 사용</label>
            <label class="pill"><input id="notifyBargainEnabled" type="checkbox" checked /> 급매 알림 사용</label>
          </div>
          <div class="split" style="margin-top: 8px">
            <input id="notifyLookbackDays" type="number" min="1" max="180" value="30" placeholder="탐지 기간(일)" />
            <input
              id="notifyDiscountThreshold"
              type="number"
              step="0.01"
              min="0.01"
              max="0.99"
              value="0.08"
              placeholder="할인율 임계값"
            />
          </div>
          <div class="row" style="margin-top: 8px">
            <button id="loadNotifyBtn">설정 조회</button>
            <button id="saveNotifyBtn" class="alt">설정 저장</button>
            <button id="dispatchAlertBtn" class="warn">지금 알림 발송</button>
          </div>
          <div class="status" id="notifyStatus"></div>
        </section>

        <section class="panel two">
          <h2>6) 단지 시세 추세</h2>
          <div class="row">
            <input id="trendComplexNo" type="number" placeholder="complex_no" />
            <input id="trendDays" type="number" value="30" min="1" />
            <button id="loadTrendBtn">차트 조회</button>
          </div>
          <canvas id="trendChart" style="margin-top: 8px; min-height: 300px"></canvas>
        </section>

        <section class="panel two">
          <h2>7) 선택 단지 비교</h2>
          <div class="row">
            <input id="compareComplexNos" type="text" placeholder="예: 12345,23456,34567" />
            <input id="compareDays" type="number" value="30" min="1" />
            <button id="loadCompareBtn">비교 조회</button>
          </div>
          <canvas id="compareChart" style="margin-top: 8px; min-height: 300px"></canvas>
        </section>

        <section class="panel">
          <h2>8) 급매 후보</h2>
          <div class="row">
            <input id="bargainComplexNo" type="number" placeholder="complex_no" />
            <input id="bargainDays" type="number" value="30" min="1" />
            <input id="bargainThreshold" type="number" step="0.01" value="0.08" min="0" max="0.99" />
            <button id="loadBargainBtn">탐지</button>
            <button id="loadMyBargainBtn" class="alt">내 관심단지 알림</button>
          </div>
          <div style="overflow: auto; margin-top: 8px">
            <table class="table">
              <thead>
                <tr>
                  <th>단지</th>
                  <th>매물번호</th>
                  <th>매물명</th>
                  <th>유형</th>
                  <th>가격</th>
                  <th>기준중앙값(만원)</th>
                  <th>할인율</th>
                </tr>
              </thead>
              <tbody id="bargainBody"></tbody>
            </table>
          </div>
        </section>
      </div>
    </div>
    <script src="/web/app.js"></script>
  </body>
</html>
